<!DOCTYPE html>
<html lang="en-US">
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2020-04-05T14:34:57-04:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>$(function () {
    // Make *any* div with class 'sagecell-sage' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-sage',
                           linked: true,
                           languages: ['sage'],
                           evalButtonText: 'Evaluate (Sage)'});
});
</script>
</head>
<body>
<article class="project-like"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">1.5.4</span>.</h6>
<ol class="lower-alpha">
<li>
<p>Suppose we are interested in finding the least squares approximate solution to the equation \(A\xvec =
\bvec\) and that we have the \(QR\) factorization of \(A\text{:}\)  \(A=QR\text{.}\)  Explain why the least squares approximation solution is given by solving</p>
<div class="displaymath">
\begin{align*}
A\xhat \amp = QQ^T\bvec \\\\
QR\xhat \amp = QQ^T\bvec \\
\end{align*}
</div>
</li>
<li>
<p>Multiply both sides of the second expression by \(Q^T\) and explain why</p>
<div class="displaymath">
\begin{equation*}
R\xhat = Q^T\bvec.
\end{equation*}
</div>
</li>
<li>
<p>Since \(R\) is upper triangular, this is a relatively simple equation to solve using back substitution, as we saw in <span>(((Unresolved xref, reference "sec-gaussian-revisited"; check spelling or use "provisional" attribute)))</span><a href="" class="internal" title=""> </a>.  We will therefore write the least squares approximate solution as</p>
<div class="displaymath">
\begin{equation*}
\xhat = R^{-1}Q^T\bvec,
\end{equation*}
</div>
<p>and put this to use in the following context.</p>
<p>Brozak’s formula, which is used to calculate a person's body fat index (\(BFI\)), is</p>
<div class="displaymath">
\begin{equation*}
BFI = 100 \left(\frac{4.57}{\rho} - 4.142\right)
\end{equation*}
</div>
<p>where \(\rho\) denotes a person's body density in grams per cubic centimeter.  Obtaining an accurate measure of \(\rho\) is difficult, however, because it requires submerging the person in water and measuring the volume of water displaced.  Instead, we will gather several other body measurements, which are more easily obtained, and use it to predict \(BFI\text{.}\)  For instance, suppose we take 10 patients and measure their weight \(w\) in pounds, height \(h\) in inches, abdomen \(a\) in centimeters, wrist circumference \(r\) in centimeters, neck circumference \(n\) in centimeters, and \(BFI\text{.}\)  Evaluating the following cell loads and displays the data. <div class="sagecell-sage" id="sage-32"><script type="text/x-sage">sage.repl.load.load('http://merganser.math.gvsu.edu/david/linear.algebra/ula/python/orthogonality.py', globals())
df = pd.read_csv('http://merganser.math.gvsu.edu/david/linear.algebra/ula/data/bfi.csv')
weight = vector(df['Weight'])
height = vector(df['Height'])
abdomen = vector(df['Abdomen'])
wrist = vector(df['Wrist'])
neck = vector(df['Neck'])
BFI = vector(df['BFI'])
print(df)
</script></div>  In addition, that cell provides:</p>
<ol class="lower-alpha">
<li><p>vectors <code class="code-inline tex2jax_ignore">weight</code>, <code class="code-inline tex2jax_ignore">height</code>, <code class="code-inline tex2jax_ignore">abdomen</code>, <code class="code-inline tex2jax_ignore">wrist</code>, <code class="code-inline tex2jax_ignore">neck</code>, and <code class="code-inline tex2jax_ignore">BFI</code> formed from the columns of the dataset.</p></li>
<li><p>the command <code class="code-inline tex2jax_ignore">onesvec(n)</code>, which returns an \(n\)-dimensional vector whose entries are all one.</p></li>
<li><p>the command <code class="code-inline tex2jax_ignore">QR(A)</code> that returns the \(QR\) factorization of \(A\) as <code class="code-inline tex2jax_ignore">Q, R =
		    QR(A)</code>.</p></li>
<li><p>the command <code class="code-inline tex2jax_ignore">demean(v)</code>, which returns the demeaned vector \(\widetilde{\vvec}\text{.}\)</p></li>
</ol>
<p>We would like to find the linear function</p>
<div class="displaymath">
\begin{equation*}
\beta_0 + \beta_1w + \beta_2h + \beta_3a + \beta_4r +
\beta_5n = BFI
\end{equation*}
</div>
<p>that best fits the data.</p>
<p>Use the first data point to write an equation for the parameters \(\beta_0,\beta_1,\ldots,\beta_5\text{.}\)</p>
</li>
<li><p>Describe the linear system \(A\xvec = \bvec\) for these parameters.  More specifically, how will you form the matrix \(A\) and the vector \(\bvec\text{?}\)</p></li>
<li><p>Form the matrix \(A\) and find its \(QR\) factorization in the cell below. <div class="sagecell-sage" id="sage-33"><script type="text/x-sage">
</script></div></p></li>
<li><p>Find the least squares approximate solution \(\xhat\) by solving the equation \(R\xhat =
Q^T\bvec\text{.}\)  You may want to use <code class="code-inline tex2jax_ignore">N(xhat)</code> to display a decimal approximation of the vector.</p></li>
<li><p>What are the parameters \(\beta_0,\beta_1,\ldots,\beta_5\) that best fit the data?</p></li>
<li><p>Find the coefficient of determination \(R^2\) for your parameters.  What does this imply about the quality of the fit? <div class="sagecell-sage" id="sage-34"><script type="text/x-sage">
</script></div></p></li>
<li><p>Suppose a person's measurements are: weight 190, height 70, abdomen 90, wrist 18, and neck 35.  Estimate this person's \(BFI\text{.}\)</p></li>
</ol></article><span class="incontext"><a href="sec-least-squares.html#activity-BFI">in-context</a></span>
</body>
</html>
