<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*       on 2022-08-08T13:56:27-04:00       *-->
<!--*   A recent stable commit (2020-08-09):   *-->
<!--* 98f21740783f166a773df4dc83cab5293ab63a4a *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Principal Component Analysis</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Understanding Linear Algebra">
<meta property="book:author" content=" David Austin ">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>window.MathJax = {
  tex: {
    inlineMath: [['\\(','\\)']],
    tags: "none",
    tagSide: "right",
    tagIndent: ".8em",
    packages: {'[+]': ['base', 'extpfeil', 'ams', 'amscd', 'newcommand', 'knowl']}
  },
  options: {
    ignoreHtmlClass: "tex2jax_ignore|ignore-math",
    processHtmlClass: "process-math",
    renderActions: {
        findScript: [10, function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        }, '']
    },
  },
  chtml: {
    scale: 0.88,
    mtextInheritFont: true
  },
  loader: {
    load: ['input/asciimath', '[tex]/extpfeil', '[tex]/amscd', '[tex]/newcommand', '[pretext]/mathjaxknowl3.js'],
    paths: {pretext: "https://pretextbook.org/js/lib"},
  },
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({inputLocation: 'pre.sagecell-sage',
                       linked: true,
                       languages: ['sage'],
                       evalButtonText: 'Evaluate (Sage)'});
</script><script async="" src="https://cse.google.com/cse.js?cx=015103900096539427448:ngwuia10qci"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.13/pretext.js"></script><script>miniversion=0.674</script><script src="https://pretextbook.org/js/0.13/pretext_add_on.js?x=1"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/style_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/colors_blue_grey.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/setcolors.css" rel="stylesheet" type="text/css">
<!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX Course: Title Here';
eBookConfig.basecourse = 'PTX Base Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.acDefaultLanguage = 'python';
eBookConfig.runestone_version = '5.0.1';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script type="text/javascript" src="https://runestone.academy/cdn/runestone/6.2.1/runtime.b0f8547c48f16a9f.bundle.js"></script><script type="text/javascript" src="https://runestone.academy/cdn/runestone/6.2.1/637.d54be67956c5c660.bundle.js"></script><script type="text/javascript" src="https://runestone.academy/cdn/runestone/6.2.1/runestone.0e9550fe42760516.bundle.js"></script><link rel="stylesheet" type="text/css" href="https://runestone.academy/cdn/runestone/6.2.1/637.fafafbd97df8a0d1.css">
<link rel="stylesheet" type="text/css" href="https://runestone.academy/cdn/runestone/6.2.1/runestone.e4d5592da655219f.css">
</head>
<body class="pretext-book ignore-math has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\avec}{{\mathbf a}}
\newcommand{\bvec}{{\mathbf b}}
\newcommand{\cvec}{{\mathbf c}}
\newcommand{\dvec}{{\mathbf d}}
\newcommand{\dtil}{\widetilde{\mathbf d}}
\newcommand{\evec}{{\mathbf e}}
\newcommand{\fvec}{{\mathbf f}}
\newcommand{\nvec}{{\mathbf n}}
\newcommand{\pvec}{{\mathbf p}}
\newcommand{\qvec}{{\mathbf q}}
\newcommand{\svec}{{\mathbf s}}
\newcommand{\tvec}{{\mathbf t}}
\newcommand{\uvec}{{\mathbf u}}
\newcommand{\vvec}{{\mathbf v}}
\newcommand{\wvec}{{\mathbf w}}
\newcommand{\xvec}{{\mathbf x}}
\newcommand{\yvec}{{\mathbf y}}
\newcommand{\zvec}{{\mathbf z}}
\newcommand{\rvec}{{\mathbf r}}
\newcommand{\mvec}{{\mathbf m}}
\newcommand{\zerovec}{{\mathbf 0}}
\newcommand{\onevec}{{\mathbf 1}}
\newcommand{\real}{{\mathbb R}}
\newcommand{\twovec}[2]{\left[\begin{array}{r}#1 \\ #2
\end{array}\right]}
\newcommand{\ctwovec}[2]{\left[\begin{array}{c}#1 \\ #2
\end{array}\right]}
\newcommand{\threevec}[3]{\left[\begin{array}{r}#1 \\ #2 \\ #3
\end{array}\right]}
\newcommand{\cthreevec}[3]{\left[\begin{array}{c}#1 \\ #2 \\ #3
\end{array}\right]}
\newcommand{\fourvec}[4]{\left[\begin{array}{r}#1 \\ #2 \\ #3 \\ #4
\end{array}\right]}
\newcommand{\cfourvec}[4]{\left[\begin{array}{c}#1 \\ #2 \\ #3 \\ #4
\end{array}\right]}
\newcommand{\fivevec}[5]{\left[\begin{array}{r}#1 \\ #2 \\ #3 \\
#4 \\ #5 \\ \end{array}\right]}
\newcommand{\cfivevec}[5]{\left[\begin{array}{c}#1 \\ #2 \\ #3 \\
#4 \\ #5 \\ \end{array}\right]}
\newcommand{\mattwo}[4]{\left[\begin{array}{rr}#1 \amp #2 \\ #3 \amp #4 \\ \end{array}\right]}
\newcommand{\laspan}[1]{\text{Span}\{#1\}}
\newcommand{\bcal}{{\cal B}}
\newcommand{\ccal}{{\cal C}}
\newcommand{\scal}{{\cal S}}
\newcommand{\wcal}{{\cal W}}
\newcommand{\ecal}{{\cal E}}
\newcommand{\coords}[2]{\left\{#1\right\}_{#2}}
\newcommand{\gray}[1]{\color{gray}{#1}}
\newcommand{\lgray}[1]{\color{lightgray}{#1}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\row}{\text{Row}}
\newcommand{\col}{\text{Col}}
\renewcommand{\row}{\text{Row}}
\newcommand{\nul}{\text{Nul}}
\newcommand{\var}{\text{Var}}
\newcommand{\corr}{\text{corr}}
\newcommand{\len}[1]{\left|#1\right|}
\newcommand{\bbar}{\overline{\bvec}}
\newcommand{\bhat}{\widehat{\bvec}}
\newcommand{\bperp}{\bvec^\perp}
\newcommand{\xhat}{\widehat{\xvec}}
\newcommand{\vhat}{\widehat{\vvec}}
\newcommand{\uhat}{\widehat{\uvec}}
\newcommand{\what}{\widehat{\wvec}}
\newcommand{\Sighat}{\widehat{\Sigma}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="ula.html"><span class="title">Understanding Linear Algebra</span></a></h1>
<p class="byline">David Austin</p>
</div>
<div class="searchwrapper" role="search"><div class="gcse-search"></div></div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3">
<a class="index-button toolbar-item button" href="index-1.html" title="Index">Index</a><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="sec-quadratic-forms.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="chap7.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="sec-svd-intro.html" title="Next">Next</a></span>
</div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="sec-quadratic-forms.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="chap7.html" title="Up">Up</a><a class="next-button button toolbar-item" href="sec-svd-intro.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link frontmatter">
<a href="frontmatter.html" data-scroll="frontmatter" class="internal"><span class="title">Front Matter</span></a><ul>
<li><a href="dedication-1.html" data-scroll="dedication-1" class="internal">Dedication</a></li>
<li><a href="colophon-1.html" data-scroll="colophon-1" class="internal">Colophon</a></li>
<li><a href="preface-1.html" data-scroll="preface-1" class="internal">Our goals</a></li>
</ul>
</li>
<li class="link">
<a href="chap1.html" data-scroll="chap1" class="internal"><span class="codenumber">1</span> <span class="title">Systems of equations</span></a><ul>
<li><a href="sec-expect.html" data-scroll="sec-expect" class="internal">What can we expect</a></li>
<li><a href="sec-finding-solutions.html" data-scroll="sec-finding-solutions" class="internal">Finding solutions to linear systems</a></li>
<li><a href="sec-sage-introduction.html" data-scroll="sec-sage-introduction" class="internal">Computation with Sage</a></li>
<li><a href="sec-pivots.html" data-scroll="sec-pivots" class="internal">Pivots and their influence on solution spaces</a></li>
</ul>
</li>
<li class="link">
<a href="chap2.html" data-scroll="chap2" class="internal"><span class="codenumber">2</span> <span class="title">Vectors, matrices, and linear combinations</span></a><ul>
<li><a href="sec-vectors-lin-combs.html" data-scroll="sec-vectors-lin-combs" class="internal">Vectors and linear combinations</a></li>
<li><a href="sec-matrices-lin-combs.html" data-scroll="sec-matrices-lin-combs" class="internal">Matrix multiplication and linear combinations</a></li>
<li><a href="sec-span.html" data-scroll="sec-span" class="internal">The span of a set of vectors</a></li>
<li><a href="sec-linear-dep.html" data-scroll="sec-linear-dep" class="internal">Linear independence</a></li>
<li><a href="sec-linear-trans.html" data-scroll="sec-linear-trans" class="internal">Matrix transformations</a></li>
<li><a href="sec-transforms-geom.html" data-scroll="sec-transforms-geom" class="internal">The geometry of matrix transformations</a></li>
</ul>
</li>
<li class="link">
<a href="chap3.html" data-scroll="chap3" class="internal"><span class="codenumber">3</span> <span class="title">Invertibility, bases, and coordinate systems</span></a><ul>
<li><a href="sec-matrix-inverse.html" data-scroll="sec-matrix-inverse" class="internal">Invertibility</a></li>
<li><a href="sec-bases.html" data-scroll="sec-bases" class="internal">Bases and coordinate systems</a></li>
<li><a href="sec-jpeg.html" data-scroll="sec-jpeg" class="internal">Image compression</a></li>
<li><a href="sec-determinants.html" data-scroll="sec-determinants" class="internal">Determinants</a></li>
<li><a href="sec-subspaces.html" data-scroll="sec-subspaces" class="internal">Subspaces</a></li>
</ul>
</li>
<li class="link">
<a href="chap4.html" data-scroll="chap4" class="internal"><span class="codenumber">4</span> <span class="title">Eigenvalues and eigenvectors</span></a><ul>
<li><a href="sec-eigen-intro.html" data-scroll="sec-eigen-intro" class="internal">An introduction to eigenvalues and eigenvectors</a></li>
<li><a href="sec-eigen-find.html" data-scroll="sec-eigen-find" class="internal">Finding eigenvalues and eigenvectors</a></li>
<li><a href="sec-eigen-diag.html" data-scroll="sec-eigen-diag" class="internal">Diagonalization, similarity, and powers of a matrix</a></li>
<li><a href="sec-dynamical.html" data-scroll="sec-dynamical" class="internal">Dynamical systems</a></li>
<li><a href="sec-stochastic.html" data-scroll="sec-stochastic" class="internal">Markov chains and Google's PageRank algorithm</a></li>
</ul>
</li>
<li class="link">
<a href="chap5.html" data-scroll="chap5" class="internal"><span class="codenumber">5</span> <span class="title">Linear algebra and computing</span></a><ul>
<li><a href="sec-gaussian-revisited.html" data-scroll="sec-gaussian-revisited" class="internal">Gaussian elimination revisited</a></li>
<li><a href="sec-power-method.html" data-scroll="sec-power-method" class="internal">Finding eigenvectors numerically</a></li>
</ul>
</li>
<li class="link">
<a href="chap6.html" data-scroll="chap6" class="internal"><span class="codenumber">6</span> <span class="title">Orthogonality and Least Squares</span></a><ul>
<li><a href="sec-dot-product.html" data-scroll="sec-dot-product" class="internal">The dot product</a></li>
<li><a href="sec-transpose.html" data-scroll="sec-transpose" class="internal">Orthogonal complements and the matrix transpose</a></li>
<li><a href="sec-orthogonal-bases.html" data-scroll="sec-orthogonal-bases" class="internal">Orthogonal bases and projections</a></li>
<li><a href="sec-gram-schmidt.html" data-scroll="sec-gram-schmidt" class="internal">Finding orthogonal bases</a></li>
<li><a href="sec-least-squares.html" data-scroll="sec-least-squares" class="internal">Orthogonal least squares</a></li>
</ul>
</li>
<li class="link">
<a href="chap7.html" data-scroll="chap7" class="internal"><span class="codenumber">7</span> <span class="title">The Spectral Theorem and singular value decompositions</span></a><ul>
<li><a href="sec-symmetric-matrices.html" data-scroll="sec-symmetric-matrices" class="internal">Symmetric matrices and variance</a></li>
<li><a href="sec-quadratic-forms.html" data-scroll="sec-quadratic-forms" class="internal">Quadratic forms</a></li>
<li><a href="sec-pca.html" data-scroll="sec-pca" class="active">Principal Component Analysis</a></li>
<li><a href="sec-svd-intro.html" data-scroll="sec-svd-intro" class="internal">Singular Value Decompositions</a></li>
<li><a href="sec-svd-uses.html" data-scroll="sec-svd-uses" class="internal">Using Singular Value Decompositions</a></li>
</ul>
</li>
<li class="link backmatter"><a href="backmatter.html" data-scroll="backmatter" class="internal"><span class="title">Back Matter</span></a></li>
<li class="link"><a href="app-sage-reference.html" data-scroll="app-sage-reference" class="internal"><span class="codenumber">A</span> <span class="title">Sage Reference</span></a></li>
<li class="link"><a href="index-1.html" data-scroll="index-1" class="internal"><span class="title">Index</span></a></li>
<li class="link"><a href="colophon-2.html" data-scroll="colophon-2" class="internal"><span class="title">Colophon</span></a></li>
</ul></nav><div class="extras"><nav><a class="pretext-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content">
<section class="section" id="sec-pca"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">7.3</span> <span class="title">Principal Component Analysis</span>
</h2>
<section class="introduction" id="introduction-36"><p id="p-7600">We are sometimes presented with a dataset having many data points that live in a high dimensional space.  For instance, we looked at a dataset describing body fat index (BFI) in <a href="" class="xref" data-knowl="./knowl/activity-BFI.html" title="Activity 6.5.4">Activity 6.5.4</a> where each data point is six-dimensional.  Developing an intuitive understanding of the data is hampered by the fact that it cannot be visualized.</p>
<p id="p-7601">This section explores a technique called <em class="emphasis">principal component analysis</em>, which enables us to reduce the dimension of a dataset so that it may be visualized or studied in a way so that interesting features more readily stand out. Our previous work with variance and the orthogonal diagonalization of symmetric matrices provides the key ideas.</p>
<article class="exploration project-like" id="exploration-28"><h3 class="heading">
<span class="type">Preview Activity</span><span class="space"> </span><span class="codenumber">7.3.1</span><span class="period">.</span>
</h3>
<p id="p-7602">We will begin by recalling our earlier discussion of variance.  Suppose we have a dataset that leads to the covariance matrix</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
C = \begin{bmatrix}
7 \amp -4 \\
-4 \amp 13
\end{bmatrix}.
\end{equation*}
</div>
<ol class="lower-alpha">
<li id="li-5275"><p id="p-7603">Suppose that <span class="process-math">\(\uvec\)</span> is a unit eigenvector of <span class="process-math">\(C\)</span> with eigenvalue <span class="process-math">\(\lambda\text{.}\)</span>  What is the variance <span class="process-math">\(V_{\uvec}\)</span> in the <span class="process-math">\(\uvec\)</span> direction?</p></li>
<li id="li-5276"><p id="p-7604">Find an orthogonal diagonalization of <span class="process-math">\(C\text{.}\)</span> <pre class="ptx-sagecell sagecell-sage" id="sage-215"><script type="text/x-sage">
</script></pre></p></li>
<li id="li-5277"><p id="p-7605">What is the total variance?</p></li>
<li id="li-5278"><p id="p-7606">In which direction is the variance greatest and what is the variance in this direction?  If we project the data onto this line, how much variance is lost?</p></li>
<li id="li-5279"><p id="p-7607">In which direction is the variance smallest and how is this direction related to the direction of maximum variance?</p></li>
</ol></article><p id="p-7614">Here are some ideas we've seen previously that will be particularly useful for us in this section.  Remember that the covariance matrix of a dataset is <span class="process-math">\(C=\frac 1N AA^T\)</span> where <span class="process-math">\(A\)</span> is the matrix of <span class="process-math">\(N\)</span> demeaned data points.</p>
<ul class="disc">
<li id="li-5285"><p id="p-7615">When <span class="process-math">\(\uvec\)</span> is a unit vector, the variance of the demeaned data after projecting onto the line defined by <span class="process-math">\(\uvec\)</span> is given by the quadratic form <span class="process-math">\(V_{\uvec} =
\uvec\cdot(C\uvec)\text{.}\)</span></p></li>
<li id="li-5286"><p id="p-7616">In particular, if <span class="process-math">\(\uvec\)</span> is a unit eigenvector of <span class="process-math">\(C\)</span> with associated eigenvalue <span class="process-math">\(\lambda\text{,}\)</span> then <span class="process-math">\(V_{\uvec} = \lambda\text{.}\)</span></p></li>
<li id="li-5287">
<p id="p-7617">Moreover, variance is additive, as we recorded in <a href="" class="xref" data-knowl="./knowl/prop-variance-additivity.html" title="Proposition 7.1.16: Additivity of Variance">Proposition 7.1.16</a>: if <span class="process-math">\(W\)</span> is a subspace having an orthonormal basis <span class="process-math">\(\uvec_1,\uvec_2,\ldots,\uvec_n\text{,}\)</span> then the variance</p>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/prop-variance-additivity.html">
\begin{equation*}
V_W = V_{\uvec_1} + V_{\uvec_2} + \ldots +
V_{\uvec_n}\text{.} 
\end{equation*}
</div>
</li>
</ul></section><section class="subsection" id="subsection-106"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">7.3.1</span> <span class="title">Principal Component Analysis</span>
</h3>
<p id="p-7618">Let's begin by looking at an example that illustrates the central theme of this technique.</p>
<article class="activity project-like" id="activity-97"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">7.3.2</span><span class="period">.</span>
</h4>
<p id="p-7619">Suppose that we work with a dataset having 100 five-dimensional data points.  The demeaned data matrix <span class="process-math">\(A\)</span> is therefore <span class="process-math">\(5\times100\)</span> and leads to the covariance matrix <span class="process-math">\(C=\frac1{100}~AA^T\text{,}\)</span> which is a <span class="process-math">\(5\times5\)</span> matrix.  Because <span class="process-math">\(C\)</span> is symmetric, the Spectral Theorem tells us it is orthogonally diagonalizable so suppose that <span class="process-math">\(C = QDQ^T\)</span> where</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
Q = \begin{bmatrix}
\uvec_1 \amp \uvec_2 \amp \uvec_3 \amp \uvec_4 \amp \uvec_5
\end{bmatrix},\hspace{24pt}
D = \begin{bmatrix}
13 \amp 0 \amp 0 \amp 0 \amp 0 \\
0 \amp 10 \amp 0 \amp 0 \amp 0 \\
0 \amp 0 \amp 2 \amp 0 \amp 0 \\
0 \amp 0 \amp 0 \amp 0 \amp 0 \\
0 \amp 0 \amp 0 \amp 0 \amp 0
\end{bmatrix}.
\end{equation*}
</div>
<ol class="lower-alpha">
<li id="li-5288"><p id="p-7620">What is <span class="process-math">\(V_{\uvec_2}\text{,}\)</span> the variance in the <span class="process-math">\(\uvec_2\)</span> direction?</p></li>
<li id="li-5289"><p id="p-7621">Find the variance of the data projected onto the line defined by <span class="process-math">\(\uvec_4\text{.}\)</span>  What does this say about the data?</p></li>
<li id="li-5290"><p id="p-7622">What is the total variance of the data?</p></li>
<li id="li-5291"><p id="p-7623">Consider the 2-dimensional subspace spanned by <span class="process-math">\(\uvec_1\)</span> and <span class="process-math">\(\uvec_2\text{.}\)</span>  If we project the data onto this subspace, what fraction of the total variance is represented by the variance of the projected data?</p></li>
<li id="li-5292"><p id="p-7624">How does this question change if we project onto the 3-dimensional subspace spanned by <span class="process-math">\(\uvec_1\text{,}\)</span> <span class="process-math">\(\uvec_2\text{,}\)</span> and <span class="process-math">\(\uvec_3\text{?}\)</span></p></li>
<li id="li-5293"><p id="p-7625">What does this tell us about the data?</p></li>
</ol></article><p id="p-7640">This activity demonstrates how the eigenvalues of the covariance matrix can tell us when data are clustered around, or even wholly contained within, a smaller dimensional subspace.  In particular, the original data is 5-dimensional, but we see that it actually lies in a 3-dimensional subspace of <span class="process-math">\(\real^5\text{.}\)</span>  Later in this section, we'll see how to use this observation to work with the data as if it were three-dimensional, an idea known as <em class="emphasis">dimensional reduction</em>.</p>
<p id="p-7641"> The eigenvectors <span class="process-math">\(\uvec_j\)</span> of the covariance matrix are called <em class="emphasis">principal components</em>, and we will order them so that their associated eigenvalues decrease.  Generally speaking, we hope that the first few principal components retain most of the variance, as the example in the activity demonstrates.  In that example, we have the sequence of subspaces</p>
<ul class="disc">
<li id="li-5306"><p id="p-7642"><span class="process-math">\(W_1\text{,}\)</span> the 1-dimensional subspace spanned by <span class="process-math">\(\uvec_1\text{,}\)</span> which retains <span class="process-math">\(13/25 = 52\%\)</span> of the total variance,</p></li>
<li id="li-5307"><p id="p-7643"><span class="process-math">\(W_2\text{,}\)</span> the 2-dimensional subspace spanned by <span class="process-math">\(\uvec_1\)</span> and <span class="process-math">\(\uvec_2\text{,}\)</span> which retains <span class="process-math">\(23/25
= 92\%\)</span> of the variance, and</p></li>
<li id="li-5308"><p id="p-7644"><span class="process-math">\(W_3\text{,}\)</span> the 3-dimensional subspace spanned by <span class="process-math">\(\uvec_1\text{,}\)</span> <span class="process-math">\(\uvec_2\text{,}\)</span> and <span class="process-math">\(\uvec_3\text{,}\)</span> which retains all of the variance.</p></li>
</ul>
<p id="p-7645">Notice how we retain more of the total variance as we increase the dimension of the subspace onto which the data are projected. Eventually, projecting the data onto <span class="process-math">\(W_3\)</span> retains all the variance, which tells us the data must lie in <span class="process-math">\(W_3\text{,}\)</span> a smaller dimensional subspace of <span class="process-math">\(\real^5\text{.}\)</span></p>
<p id="p-7646">In fact, these subspaces are the best possible.  We know that the first principal component <span class="process-math">\(\uvec_1\)</span> is the eigenvector of <span class="process-math">\(C\)</span> associated to the largest eigenvalue.  This means that the variance is as large as possible in the <span class="process-math">\(\uvec_1\)</span> direction.  In other words, projecting onto any other line will retain a smaller amount of variance.  Similarly, projecting onto any other 2-dimensional subspace besides <span class="process-math">\(W_2\)</span> will retain less variance than projecting onto <span class="process-math">\(W_2\text{.}\)</span>  The principal components have the wonderful ability to pick out the best possible subspaces to retain as much variance as possible.</p>
<p id="p-7647">Of course, this is a contrived example.  Typically, the presence of noise in a dataset means that we do not expect all the points to be wholly contained in a smaller dimensional subspace.  In fact, the 2-dimensional subspace <span class="process-math">\(W_2\)</span> retains <span class="process-math">\(92\%\)</span> of the variance.  Depending on the situation, we may want to write off the remaining <span class="process-math">\(8\%\)</span> of the variance as noise in exchange for the convenience of working with a smaller dimensional subspace.  As we'll see later, we will seek a balance using a number of principal components large enough to retain most of the variance but small enough to be easy to work with.</p>
<article class="activity project-like" id="activity-98"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">7.3.3</span><span class="period">.</span>
</h4>
<p id="p-7648">We will work here with a dataset having 100 3-dimensional demeaned data points.  Evaluating the following cell will plot those data points and define the demeaned data matrix <code class="code-inline tex2jax_ignore">A</code> whose shape is <span class="process-math">\(3\times100\text{.}\)</span> <pre class="ptx-sagecell sagecell-sage" id="sage-216"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/pca_demo.py', globals())
</script></pre> Notice that the data appears to cluster around a plane though it does not seem to be wholly contained within that plane.</p>
<ol class="lower-alpha">
<li id="li-5309"><p id="p-7649">Use the matrix <code class="code-inline tex2jax_ignore">A</code> to construct the covariance matrix <span class="process-math">\(C\text{.}\)</span>  Then determine the variance in the direction of <span class="process-math">\(\uvec=\threevec{1/3}{2/3}{2/3}\text{?}\)</span> <pre class="ptx-sagecell sagecell-sage" id="sage-217"><script type="text/x-sage">
</script></pre></p></li>
<li id="li-5310"><p id="p-7650">Find the eigenvalues of <span class="process-math">\(C\)</span> and determine the total variance. <pre class="ptx-sagecell sagecell-sage" id="sage-218"><script type="text/x-sage">
</script></pre> Notice that Sage does not necessarily sort the eigenvalues in decreasing order.</p></li>
<li id="li-5311"><p id="p-7651">Use the <code class="code-inline tex2jax_ignore">right_eigenmatrix()</code> command to find the eigenvectors of <span class="process-math">\(C\text{.}\)</span>  Remembering that the Sage command <code class="code-inline tex2jax_ignore">B.column(1)</code> retrieves the vector represented by the second column of <code class="code-inline tex2jax_ignore">B</code>, define vectors <code class="code-inline tex2jax_ignore">u1</code>, <code class="code-inline tex2jax_ignore">u2</code>, and <code class="code-inline tex2jax_ignore">u3</code> representing the three principal components in order of decreasing eigenvalues.  How can you check if these vectors are an orthonormal basis for <span class="process-math">\(\real^3\text{?}\)</span></p></li>
<li id="li-5312"><p id="p-7652">What fraction of the total variance is retained by projecting the data onto <span class="process-math">\(W_1\text{,}\)</span> the subspace spanned by <span class="process-math">\(\uvec_1\text{?}\)</span>  What fraction of the total variance is retained by projecting onto <span class="process-math">\(W_2\text{,}\)</span> the subspace spanned by <span class="process-math">\(\uvec_1\)</span> and <span class="process-math">\(\uvec_2\text{?}\)</span>  What fraction of the total variance do we lose by projecting onto <span class="process-math">\(W_2\text{?}\)</span></p></li>
<li id="li-5313">
<p id="p-7653">If we project a data point <span class="process-math">\(\xvec\)</span> onto <span class="process-math">\(W_2\text{,}\)</span> the Projection Formula tells us we obtain</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
\xhat = (\uvec_1\cdot\xvec) \uvec_1 +
(\uvec_2\cdot\xvec) \uvec_2.
\end{equation*}
</div>
<p class="continuation">Rather than viewing the projected data in <span class="process-math">\(\real^3\text{,}\)</span> we will record the coordinates of <span class="process-math">\(\xhat\)</span> in the basis defined by <span class="process-math">\(\uvec_1\)</span> and <span class="process-math">\(\uvec_2\text{;}\)</span>  that is, we will record the coordinates</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
\twovec{\uvec_1\cdot\xvec}{\uvec_2\cdot\xvec}.  
\end{equation*}
</div>
<p class="continuation">Construct the matrix <span class="process-math">\(Q\)</span> so that <span class="process-math">\(Q^T\xvec =
\twovec{\uvec_1\cdot\xvec}{\uvec_2\cdot\xvec}\text{.}\)</span> <pre class="ptx-sagecell sagecell-sage" id="sage-219"><script type="text/x-sage">
</script></pre></p>
</li>
<li id="li-5314"><p id="p-7654">Since each column of <span class="process-math">\(A\)</span> represents a data point, the matrix <span class="process-math">\(Q^TA\)</span> represents the coordinates of the projected data points.  Evaluating the following cell will plot those projected data points. <pre class="ptx-sagecell sagecell-sage" id="sage-220"><script type="text/x-sage">pca_plot(Q.T*A)
</script></pre> Notice how this plot enables us to view the data as if it were two-dimensional. Why is this plot wider than it is tall?</p></li>
</ol></article><p id="p-7669">This example is a more realistic illustration of principal component analysis.  The plot of the 3-dimensional data appears to show that the data lies close to a plane, and the principal components will identify this plane.  Starting with the <span class="process-math">\(3\times100\)</span> matrix of demeaned data <span class="process-math">\(A\text{,}\)</span> we construct the covariance matrix <span class="process-math">\(C=\frac{1}{100} ~AA^T\)</span> and study its eigenvalues.  Notice that the first two principal components account for more than 98% of the variance, which means we can expect the points to lie close to <span class="process-math">\(W_2\text{,}\)</span> the two-dimensional subspace spanned by <span class="process-math">\(\uvec_1\)</span> and <span class="process-math">\(\uvec_2\text{.}\)</span></p>
<p id="p-7670">Since <span class="process-math">\(W_2\)</span> is a subspace of <span class="process-math">\(\real^3\text{,}\)</span> projecting the data points onto <span class="process-math">\(W_2\)</span> gives a list of 100 points in <span class="process-math">\(\real^3\text{.}\)</span>  In order to visualize them more easily, we instead consider the coordinates of the projections in the basis defined by <span class="process-math">\(\uvec_1\)</span> and <span class="process-math">\(\uvec_2\text{.}\)</span>  For instance, we know that the projection of a data point <span class="process-math">\(\xvec\)</span> is</p>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/fig-pca-coords.html">
\begin{equation*}
\xhat = (\uvec_1\cdot\xvec)\uvec_1 +
(\uvec_2\cdot\xvec)\uvec_2,
\end{equation*}
</div>
<p class="continuation">which is a three-dimensional vector.  Instead, we can record the coordinates <span class="process-math">\(\twovec{\uvec_1\cdot\xvec}{\uvec_2\cdot\xvec}\)</span> and plot them in the two-dimensional coordinate plane, as illustrated in <a href="" class="xref" data-knowl="./knowl/fig-pca-coords.html" title="Figure 7.3.1">Figure 7.3.1</a>.</p>
<figure class="figure figure-like" id="fig-pca-coords"><div class="sidebyside"><div class="sbsrow" style="margin-left:2.5%;margin-right:2.5%;">
<div class="sbspanel top" style="width:52.6315789473684%;"><img src="external/images/pca-proj.svg" role="img" class="contained"></div>
<div class="sbspanel top" style="width:42.1052631578947%;"><img src="external/images/pca-coords.svg" role="img" class="contained"></div>
</div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.3.1<span class="period">.</span></span><span class="space"> </span>The projection <span class="process-math">\(\xhat\)</span> of a data point <span class="process-math">\(\xvec\)</span> onto <span class="process-math">\(W_2\)</span> is a three-dimensional vector, which may be represented by the two coordinates describing this vector as a linear combination of <span class="process-math">\(\uvec_1\)</span> and <span class="process-math">\(\uvec_2\text{.}\)</span></figcaption></figure><p id="p-7671">If we form the matrix <span class="process-math">\(Q=\begin{bmatrix}\uvec_1 \amp \uvec_2
\end{bmatrix}\text{,}\)</span> then we have</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
Q^T\xvec = \twovec{\uvec_1\cdot\xvec}{\uvec_2\cdot\xvec}.
\end{equation*}
</div>
<p class="continuation">This means that the columns of <span class="process-math">\(Q^TA\)</span> represent the coordinates of the projected points, which may now be plotted in the plane.</p>
<p id="p-7672">In this plot, the first coordinate, represented by the horizontal coordinate, represents the projection of a data point onto the line defined by <span class="process-math">\(\uvec_1\)</span> while the second coordinate represents the projection onto the line defined by <span class="process-math">\(\uvec_2\text{.}\)</span>  Since <span class="process-math">\(\uvec_1\)</span> is the first principal component, the variance in the <span class="process-math">\(\uvec_1\)</span> direction is greater than the variance in the <span class="process-math">\(\uvec_2\)</span> direction.  For this reason, the plot will be more spread out in the horizontal direction than in the vertical.</p></section><section class="subsection" id="subsection-107"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">7.3.2</span> <span class="title">Using Principal Component Analysis</span>
</h3>
<p id="p-7673">Now that we've explored the ideas behind principal component analysis, we will look at a few examples that illustrate its use.</p>
<article class="activity project-like" id="activity-99"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">7.3.4</span><span class="period">.</span>
</h4>
<p id="p-7674">The next cell will load a dataset describing the average consumption of various food groups for citizens in each of the four nations of the United Kingdom.  The units for each entry are grams per person per week. <pre class="ptx-sagecell sagecell-sage" id="sage-221"><script type="text/x-sage">import pandas as pd
df = pd.read_csv('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/data/uk-diet.csv', index_col=0)
data_mean = vector(df.T.mean())
A = matrix([vector(row) for row in (df.T-df.T.mean()).values]).T
df
</script></pre> We will view this as a dataset consisting of four points in <span class="process-math">\(\real^{17}\text{.}\)</span>  As such, it is impossible to visualize and studying the numbers themselves doesn't lead to much insight.</p>
<p id="p-7675">In addition to loading the data, evaluating the cell above created a vector <code class="code-inline tex2jax_ignore">data_mean</code>, which is the mean of the four data points, and <code class="code-inline tex2jax_ignore">A</code>, the <span class="process-math">\(17\times4\)</span> matrix of demeaned data.</p>
<ol class="lower-alpha">
<li id="li-5327"><p id="p-7676">What is the average consumption of Beverages across the four nations? <pre class="ptx-sagecell sagecell-sage" id="sage-222"><script type="text/x-sage">
</script></pre></p></li>
<li id="li-5328"><p id="p-7677">Find the covariance matrix <span class="process-math">\(C\)</span> and its eigenvalues.  Because there are four points in <span class="process-math">\(\real^{17}\)</span> whose mean is zero, there are only three nonzero eigenvalues.</p></li>
<li id="li-5329"><p id="p-7678">For what percentage of the total variance does the first principal component account?</p></li>
<li id="li-5330">
<p id="p-7679">Find the first principal component <span class="process-math">\(\uvec_1\)</span> and project the four demeaned data points onto the line defined by <span class="process-math">\(\uvec_1\text{.}\)</span>  Plot those points on <a href="" class="xref" data-knowl="./knowl/fig-pca-1d.html" title="Figure 7.3.2">Figure 7.3.2</a></p>
<figure class="figure figure-like" id="fig-pca-1d"><div class="sidebyside"><div class="sbsrow" style="margin-left:5%;margin-right:5%;"><div class="sbspanel top" style="width:100%;"><img src="external/images/pca-plot-1.svg" role="img" class="contained"></div></div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.3.2<span class="period">.</span></span><span class="space"> </span>A plot of the demeaned data projected onto the first principal component.</figcaption></figure>
</li>
<li id="li-5331"><p id="p-7680">For what percentage of the total variance do the first two principal components account?</p></li>
<li id="li-5332">
<p id="p-7681">Find the coordinates of the demeaned data points projected onto <span class="process-math">\(W_2\text{,}\)</span> the two-dimensional subspace of <span class="process-math">\(\real^{17}\)</span> spanned by the first two principal components. <pre class="ptx-sagecell sagecell-sage" id="sage-223"><script type="text/x-sage">
</script></pre></p>
<p id="p-7682">Plot these coordinates in <a href="" class="xref" data-knowl="./knowl/fig-pca-2d.html" title="Figure 7.3.3">Figure 7.3.3</a>.</p>
<figure class="figure figure-like" id="fig-pca-2d"><div class="sidebyside"><div class="sbsrow" style="margin-left:5%;margin-right:5%;"><div class="sbspanel top" style="width:100%;"><img src="external/images/pca-plot-2.svg" role="img" class="contained"></div></div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.3.3<span class="period">.</span></span><span class="space"> </span>The coordinates of the demeaned data points projected onto the first two principal components.</figcaption></figure>
</li>
<li id="li-5333"><p id="p-7683">What information do these plots reveal that is not clear from consideration of the original data points?</p></li>
<li id="li-5334"><p id="p-7684">Study the first principal component <span class="process-math">\(\uvec_1\)</span> and find the first component of <span class="process-math">\(\uvec_1\text{,}\)</span> which corresponds to the dietary category Alcoholic Drinks. (To do this, you may wish to use <code class="code-inline tex2jax_ignore">N(u1, digits=2)</code> for a result that's easier to read.) If a data point lies on the far right side of the plot in <a href="" class="xref" data-knowl="./knowl/fig-pca-2d.html" title="Figure 7.3.3">Figure 7.3.3</a>, what does it mean about that nation's consumption of Alcoholic Drinks?</p></li>
</ol></article><p id="p-7703">This activity demonstrates how principal component analysis enables us to extract information from a dataset that may not be easily obtained otherwise.  As in our previous example, we see that the data points lie quite close to a two-dimensional subspace of <span class="process-math">\(\real^{17}\text{.}\)</span>  In fact, <span class="process-math">\(W_2\text{,}\)</span> the subspace spanned by the first two principal components, accounts for more than 96% of the variance. More importantly, when we project the data onto <span class="process-math">\(W_2\text{,}\)</span> it becomes apparent that Northern Ireland is fundamentally different from the other three nations.</p>
<p id="p-7704">With some additional thought, we can determine more specific ways in which Northern Ireland is different.  On the <span class="process-math">\(2\)</span>-dimensional plot, Northern Ireland lies far to the right compared to the other three nations.  Since the data has been demeaned, the origin <span class="process-math">\((0,0)\)</span> in this plot corresponds to the average of the four nations.  The coordinates of the point representing Northern Ireland are about <span class="process-math">\((477, 59)\text{,}\)</span> meaning that the projected data point differs from the mean by about <span class="process-math">\(477\uvec_1+59\uvec_2\text{.}\)</span></p>
<p id="p-7705">Let's just focus on the contribution from <span class="process-math">\(\uvec_1\text{.}\)</span>  We see that the ninth component of <span class="process-math">\(\uvec_1\text{,}\)</span> the one that describes Fresh Fruit, is about <span class="process-math">\(-0.63\text{.}\)</span>  This means that the ninth component of <span class="process-math">\(477\uvec_1\)</span> differs from the mean by about <span class="process-math">\(477(-0.63) = -300\)</span> grams per person per week.  So roughly speaking, people in Northern Ireland are eating about 300 fewer grams of Fresh Fruit than the average across the four nations.  This is borne out by looking at the original data, which show that the consumption of Fresh Fruit in Northern Ireland is significantly less than the other nations.  Examing the other components of <span class="process-math">\(\uvec_1\)</span> shows other ways in which Northern Ireland differs from the other three nations.</p>
<article class="activity project-like" id="activity-pca-iris"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">7.3.5</span><span class="period">.</span>
</h4>
<p id="p-7706">In this activity, we'll look at a <a class="external" href="https://archive.ics.uci.edu/ml/datasets/Iris" target="_blank">well-known dataset</a><a href="" data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-3" id="fn-3"><sup> 1 </sup></a> that describes 150 irises representing three species of iris: Iris setosa, Iris versicolor, and Iris virginica. For each flower, the length and width of its sepal and the length and width of its petal, all in centimeters, are recorded.</p>
<figure class="figure figure-like" id="fig-iris"><div class="sidebyside"><div class="sbsrow" style="margin-left:15%;margin-right:15%;"><div class="sbspanel top" style="width:100%;"><img src="external/images/Iris_versicolor.jpg" class="contained"></div></div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.3.8<span class="period">.</span></span><span class="space"> </span>One of the three species, iris versicolor, represented in the dataset showing three shorter petals and three longer sepals. (Source: <a class="external" href="https://commons.wikimedia.org/wiki/File:Iris_versicolor_3.jpg" target="_blank">Wikipedia</a><a href="" data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-4" id="fn-4"><sup> 2 </sup></a>, License: <a class="external" href="https://commons.wikimedia.org/wiki/Commons:GNU_Free_Documentation_License,_version_1.2" target="_blank">GNU Free DOcumetation License</a><a href="" data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-5" id="fn-5"><sup> 3 </sup></a>)</figcaption></figure><p id="p-7707">Evaluating the following cell will load the dataset, which consists of 150 points in <span class="process-math">\(\real^4\text{.}\)</span>  In addition, we have a vector <code class="code-inline tex2jax_ignore">data_mean</code>, a four-dimensional vector holding the mean of the data points, and <code class="code-inline tex2jax_ignore">A</code>, the <span class="process-math">\(4\times150\)</span> demeaned data matrix. <pre class="ptx-sagecell sagecell-sage" id="sage-224"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/pca_iris.py', globals())
df.T
</script></pre> Since the data is four-dimensional, we are not able to visualize it.  Of course, we could forget about two of the measurements and plot the 150 points represented by their, say, sepal length and sepal width. <pre class="ptx-sagecell sagecell-sage" id="sage-225"><script type="text/x-sage">sepal_plot()
</script></pre></p>
<ol class="lower-alpha">
<li id="li-5351"><p id="p-7708">What is the mean sepal width?</p></li>
<li id="li-5352"><p id="p-7709">Find the covariance matrix <span class="process-math">\(C\)</span> and its eigenvalues. <pre class="ptx-sagecell sagecell-sage" id="sage-226"><script type="text/x-sage">
</script></pre></p></li>
<li id="li-5353"><p id="p-7710">Find the fraction of variance for which the first two principal components account.</p></li>
<li id="li-5354"><p id="p-7711">Construct the first two principal components <span class="process-math">\(\uvec_1\)</span> and <span class="process-math">\(\uvec_2\)</span> along with the matrix <span class="process-math">\(Q\)</span> whose columns are <span class="process-math">\(\uvec_1\)</span> and <span class="process-math">\(\uvec_2\text{.}\)</span> <pre class="ptx-sagecell sagecell-sage" id="sage-227"><script type="text/x-sage">
</script></pre></p></li>
<li id="li-5355"><p id="p-7712">As we have seen, the columns of the matrix <span class="process-math">\(Q^TA\)</span> hold the coordinates of the demeaned data points after projecting onto <span class="process-math">\(W_2\text{,}\)</span> the subspace spanned by the first two principal components.  Evaluating the following cell shows a plot of these coordinates. <pre class="ptx-sagecell sagecell-sage" id="sage-228"><script type="text/x-sage">pca_plot(Q.T*A)
</script></pre> Suppose we have a flower whose coordinates in this plane are <span class="process-math">\((-2.5, -0.75)\text{.}\)</span>  To what species does this iris most likely belong?  Find an estimate of the sepal length, sepal width, petal length, and petal width for this flower.</p></li>
<li id="li-5356"><p id="p-7713">Suppose you have an iris, but you only know that its sepal length is 5.65 cm and its sepal width is 2.75 cm.  Knowing only these two measurements, determine the coordinates <span class="process-math">\((c_1, c_2)\)</span> in the plane where this iris lies.  To what species does this iris most likely belong?  Now estimate the petal length and petal width of this iris. <pre class="ptx-sagecell sagecell-sage" id="sage-229"><script type="text/x-sage">
</script></pre></p></li>
<li id="li-5357"><p id="p-7714">Suppose you find another iris whose sepal width is 3.2 cm and whose petal width is 2.2 cm.  Find the coordinates <span class="process-math">\((c_1, c_2)\)</span> of this iris and determine the species to which it most likely belongs.  Also, estimate the sepal length and the petal length. <pre class="ptx-sagecell sagecell-sage" id="sage-230"><script type="text/x-sage">
</script></pre></p></li>
</ol></article></section><section class="subsection" id="subsection-108"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">7.3.3</span> <span class="title">Summary</span>
</h3>
<p id="p-7731">This section has explored principal component analysis as a technique to reduce the dimension of a dataset.  From the demeaned data matrix <span class="process-math">\(A\text{,}\)</span> we form the covariance matrix <span class="process-math">\(C= \frac1N ~AA^T\text{,}\)</span> where <span class="process-math">\(N\)</span> is the number of data points.</p>
<ul class="disc">
<li id="li-5372"><p id="p-7732">The eigenvectors <span class="process-math">\(\uvec_1, \uvec_2, \ldots \uvec_m\text{,}\)</span> of <span class="process-math">\(C\)</span> are called the principal components.  We arrange them so that their corresponding eigenvalues are in decreasing order.</p></li>
<li id="li-5373"><p id="p-7733">If <span class="process-math">\(W_n\)</span> is the subspace spanned by the first <span class="process-math">\(n\)</span> principal components, then the variance of the demeaned data projected onto <span class="process-math">\(W_n\)</span> is the sum of the first <span class="process-math">\(n\)</span> eigenvalues of <span class="process-math">\(C\text{.}\)</span>  No other <span class="process-math">\(n\)</span>-dimensional subspace retains more variance when the data is projected onto it.</p></li>
<li id="li-5374"><p id="p-7734">If <span class="process-math">\(Q\)</span> is the matrix whose columns are the first <span class="process-math">\(n\)</span> principal components, then the columns of <span class="process-math">\(Q^TA\)</span> hold the coordinates, expressed in the basis <span class="process-math">\(\uvec_1,\ldots,\uvec_n\text{,}\)</span> of the data once projected onto <span class="process-math">\(W_n\text{.}\)</span></p></li>
<li id="li-5375"><p id="p-7735">Our goal is to use a number of principal components that is large enough to retain most of the variance in the dataset but small enough to be manageable.</p></li>
</ul></section><section class="exercises" id="exercises-29"><h3 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber">7.3.4</span> <span class="title">Exercises</span>
</h3>
<article class="exercise exercise-like" id="exercise-269"><h4 class="heading"><span class="codenumber">1<span class="period">.</span></span></h4>
<p id="p-7736">Suppose that</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
Q = \begin{bmatrix}
-1/\sqrt{2} \amp 1/\sqrt{2} \\
1/\sqrt{2} \amp 1/\sqrt{2} \\
\end{bmatrix}, \hspace{24pt}
D_1 = \begin{bmatrix}
75 \amp 0 \\
0 \amp 74
\end{bmatrix}, \hspace{24pt}
D_2 = \begin{bmatrix}
100 \amp 0 \\
0 \amp 1 
\end{bmatrix}
\end{equation*}
</div>
<p class="continuation">and that we have two datasets, one whose covariance matrix is <span class="process-math">\(C_1 = QD_1Q^T\)</span> and one whose covariance matrix is <span class="process-math">\(C_2 = QD_2Q^T\text{.}\)</span> For each dataset, find</p>
<ol class="lower-alpha">
<li id="li-5376"><p id="p-7737">the total variance.</p></li>
<li id="li-5377"><p id="p-7738">the fraction of variance represented by the first principal component.</p></li>
<li id="li-5378"><p id="p-7739">a verbal description of how the demeaned data points appear when plotted in the plane.</p></li>
</ol></article><article class="exercise exercise-like" id="exercise-270"><h4 class="heading"><span class="codenumber">2<span class="period">.</span></span></h4>
<p id="p-7748">Suppose that a dataset has mean <span class="process-math">\(\threevec{13}{5}{7}\)</span> and that its associated covariance matrix is <span class="process-math">\(C=\begin{bmatrix}
275 \amp -206 \amp 251 \\
-206 \amp 320 \amp -206 \\
251 \amp -206 \amp 275
\end{bmatrix}
\text{.}\)</span> <pre class="ptx-sagecell sagecell-sage" id="sage-231"><script type="text/x-sage">
</script></pre></p>
<ol class="lower-alpha">
<li id="li-5385"><p id="p-7749">What fraction of the variance is represented by the first two principal components?</p></li>
<li id="li-5386"><p id="p-7750">If <span class="process-math">\(\threevec{30}{-3}{26}\)</span> is one of the data points, find the coordinates when the demeaned point is projected into the plane defined by the first two principal components.</p></li>
<li id="li-5387"><p id="p-7751">If a projected data point has coordinates <span class="process-math">\(\twovec{12}{-25}\text{,}\)</span> find an estimate for the original data point.</p></li>
</ol></article><article class="exercise exercise-like" id="exercise-271"><h4 class="heading"><span class="codenumber">3<span class="period">.</span></span></h4>
<p id="p-7760">Evaluating the following cell loads a <span class="process-math">\(2\times100\)</span> demeaned data matrix <code class="code-inline tex2jax_ignore">A</code>. <pre class="ptx-sagecell sagecell-sage" id="sage-232"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/pca_ex.py', globals())
</script></pre></p>
<ol class="lower-alpha">
<li id="li-5394"><p id="p-7761">Find the principal components <span class="process-math">\(\uvec_1\)</span> and <span class="process-math">\(\uvec_2\)</span> and the variance in the direction of each principal component.</p></li>
<li id="li-5395"><p id="p-7762">What is the total variance?</p></li>
<li id="li-5396"><p id="p-7763">What can you conclude about this dataset?</p></li>
</ol></article><article class="exercise exercise-like" id="exercise-272"><h4 class="heading"><span class="codenumber">4<span class="period">.</span></span></h4>
<p id="p-7772">Determine whether the following statements are true or false and explain your thinking.</p>
<ol class="lower-alpha">
<li id="li-5403"><p id="p-7773">If the eigenvalues of the covariance matrix are <span class="process-math">\(\lambda_1\text{,}\)</span> <span class="process-math">\(\lambda_2\text{,}\)</span> and <span class="process-math">\(\lambda_3\text{,}\)</span> then <span class="process-math">\(\lambda_3\)</span> is the variance of the demeaned data points when projected on the third principal component <span class="process-math">\(\uvec_3\text{.}\)</span></p></li>
<li id="li-5404"><p id="p-7774">Principal component analysis always allows us to construct a smaller dimensional representation of a dataset without losing any information.</p></li>
<li id="li-5405"><p id="p-7775">If the eigenvalues of the covariance matrix are 56, 32, and 0, then the demeaned data points all lie on a line in <span class="process-math">\(\real^3\text{.}\)</span></p></li>
</ol></article><article class="exercise exercise-like" id="exercise-273"><h4 class="heading"><span class="codenumber">5<span class="period">.</span></span></h4>
<p id="p-7784">In <a href="" class="xref" data-knowl="./knowl/activity-pca-iris.html" title="Activity 7.3.5">Activity 7.3.5</a>, we looked at a dataset consisting of four measurements of 150 irises.  These measurements are sepal length, sepal width, petal length, and petal width.</p>
<ol class="lower-alpha">
<li id="li-5412"><p id="p-7785">Find the first principal component <span class="process-math">\(\uvec_1\)</span> and describe the meaning of its four components.  Which component is most significant? What can you say about the relative importance of the four measurements?</p></li>
<li id="li-5413"><p id="p-7786">When the dataset is plotted in the plane defined by <span class="process-math">\(\uvec_1\)</span> and <span class="process-math">\(\uvec_2\text{,}\)</span> the specimens from the species iris-setosa lie on the left side of the plot.  What does this tell us about how iris-setosa differs from the other two species in the four measurements?</p></li>
<li id="li-5414"><p id="p-7787">In general, which species is closest to the “average iris”?</p></li>
</ol></article><article class="exercise exercise-like" id="exercise-274"><h4 class="heading"><span class="codenumber">6<span class="period">.</span></span></h4>
<p id="p-7796">This problem explores a dataset describing 333 penguins. There are three species, Adelie, Chinstrap, and Gentoo, as illustrated on the left of <a href="" class="xref" data-knowl="./knowl/fig-penguins.html" title="Figure 7.3.9">Figure 7.3.9</a>, as well as both male and female penguins in the dataset.</p>
<figure class="figure figure-like" id="fig-penguins"><div class="sidebyside"><div class="sbsrow" style="margin-left:2.5%;margin-right:2.5%;">
<div class="sbspanel top" style="width:57.8947368421053%;"><img src="external/images/lter_penguins.png" class="contained"></div>
<div class="sbspanel top" style="width:36.8421052631579%;"><img src="external/images/culmen_depth.png" class="contained"></div>
</div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.3.9<span class="period">.</span></span><span class="space"> </span>Artwork by <a class="external" href="https://github.com/allisonhorst/palmerpenguins/blob/master/README.md" target="_blank">@allison_horst</a><a href="" data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-6" id="fn-6"><sup> 4 </sup></a></figcaption></figure><p id="p-7797">Evaluating the next cell will load and display the data.  The meaning of the culmen length and width is contained in the illustration on the right of <a href="" class="xref" data-knowl="./knowl/fig-penguins.html" title="Figure 7.3.9">Figure 7.3.9</a>. <pre class="ptx-sagecell sagecell-sage" id="sage-233"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/pca_penguins.py', globals())
df.T
</script></pre> This dataset is a bit different from others that we've looked at because the scale of the measurements is significantly different.  For instance, the measurements for the body mass are roughly 100 times as large as those for the culmen length. For this reason, we will standardize the data by first demeaning it, as usual, and then rescaling each measurement by the reciprocal of its standard deviation.  The result is stored in the <span class="process-math">\(4\times333\)</span> matrix <code class="code-inline tex2jax_ignore">A</code>. <pre class="ptx-sagecell sagecell-sage" id="sage-234"><script type="text/x-sage">
</script></pre></p>
<ol class="lower-alpha">
<li id="li-5421"><p id="p-7798">Find the covariance matrix and its eigenvalues.</p></li>
<li id="li-5422"><p id="p-7799">What fraction of the total variance is explained by the first two principal components?</p></li>
<li id="li-5423"><p id="p-7800">Construct the <span class="process-math">\(2\times333\)</span> matrix <span class="process-math">\(B\)</span> whose columns are the coordinates of the demeaned data points projected onto the first two principal components. The following cell will create the plot. <pre class="ptx-sagecell sagecell-sage" id="sage-235"><script type="text/x-sage">pca_plot(B)
</script></pre></p></li>
<li id="li-5424"><p id="p-7801">Examine the components of the first two principal component vectors. How does the body mass of Gentoo penguins compare to that of the other two species?</p></li>
<li id="li-5425"><p id="p-7802">What seems to be generally true about the culmen measurements for a Chinstrap penguin compared to a Adelie?</p></li>
<li id="li-5426"><p id="p-7803">You can plot just the males or females using the following cell. <pre class="ptx-sagecell sagecell-sage" id="sage-236"><script type="text/x-sage">pca_plot(B, sex='female')
</script></pre> What seems to be generally true about the body mass measurements for a male Gentoo compared to a female Gentoo?</p></li>
</ol></article></section></section><div class="hidden-content tex2jax_ignore" id="hk-fn-3"><div class="fn"><code class="code-inline tex2jax_ignore">archive.ics.uci.edu</code></div></div>
<div class="hidden-content tex2jax_ignore" id="hk-fn-4"><div class="fn"><code class="code-inline tex2jax_ignore">gvsu.edu/s/21D</code></div></div>
<div class="hidden-content tex2jax_ignore" id="hk-fn-5"><div class="fn"><code class="code-inline tex2jax_ignore">gvsu.edu/s/21E</code></div></div>
<div class="hidden-content tex2jax_ignore" id="hk-fn-6"><div class="fn"><code class="code-inline tex2jax_ignore">gvsu.edu/s/21G</code></div></div>
</div></main>
</div>
</body>
</html>
